(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,n){e.exports={header:"App_header__1OcTw",content:"App_content__2NFRB","route-points-block":"App_route-points-block__13di5"}},23:function(e,t,n){e.exports={point:"Point_point__hpG5b",icon:"Point_icon__3kwkM"}},41:function(e,t,n){e.exports={input:"PointInput_input__1Aqub"}},42:function(e,t,n){e.exports=n.p+"static/media/delete.777b93c6.svg"},49:function(e,t,n){e.exports=n(97)},54:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(39),i=n.n(r),s=(n(54),n(48)),c=n(26),u=n(40),p=n(3),l=n(4),d=n(6),h=n(5),m=n(7),f=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.name,a=t.coords;this.marker=new window.ymaps.Placemark(a,{balloonContent:n},{draggable:!0}),this.marker.events.add("dragend",function(t){e.props.handleMoveMarker(e.props.index,t.get("target").geometry.getCoordinates())}),this.props.map.geoObjects.add(this.marker),this.props.map.setCenter(a)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.coords,a=t.name;e.coords[0]===n[0]&&e.coords[1]===n[1]||(this.marker.geometry.setCoordinates(n),this.marker.properties.set({balloonContent:a}))}},{key:"componentWillUnmount",value:function(){var e=this;this.props.map.geoObjects.remove(this.marker),this.marker.events.remove("dragend",function(t){e.props.handleMoveMarker(e.props.index,t.get("target").geometry.getCoordinates())})}},{key:"render",value:function(){return null}}]),t}(o.a.PureComponent),g=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.route=new window.ymaps.Polyline(this.props.data,null,{strokeWidth:3}),this.props.map.geoObjects.add(this.route)}},{key:"componentDidUpdate",value:function(e){var t=this.props.data;if(e.data.length!==t.length)this.route.geometry.setCoordinates(t);else for(var n=0;n<t.length;n++)t[n]!==e.data[n]&&this.route.geometry.setCoordinates(t)}},{key:"componentWillUnmount",value:function(){this.props.map.geoObjects.remove(this.route)}},{key:"render",value:function(){return null}}]),t}(o.a.PureComponent),v=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.ymaps.ready(function(){e.map=new window.ymaps.Map("map",{center:[55.76,37.64],zoom:9})})}},{key:"render",value:function(){var e=this,t=this.props.points.map(function(t,n){return o.a.createElement(f,{key:n,index:n,coords:t.coords,name:t.name,map:e.map,handleMoveMarker:e.props.handleMoveMarker})}),n=this.props.points.map(function(e){return e.coords});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"map",style:{width:"50vw",height:"90vh"}}),t,n.length>1&&o.a.createElement(g,{data:n,map:this.map}))}}]),t}(o.a.PureComponent),b=n(41),k=n.n(b),y=function(e){var t=e.handleChange,n=e.handleKeyDown,a=e.value;return o.a.createElement("input",{className:k.a.input,name:"inputValue",onChange:t,onKeyDown:n,value:a})},O=n(10),j=n(42),w=n.n(j),E=n(23),D=n.n(E),C=function(e){var t=e.name,n=e.index,a=e.handleDelete;return o.a.createElement(O.b,{draggableId:t+n,index:n},function(e){return o.a.createElement("div",Object.assign({},e.draggableProps,e.dragHandleProps,{ref:e.innerRef,className:D.a.point}),o.a.createElement("span",null,t),o.a.createElement("img",{className:D.a.icon,src:w.a,alt:"Delete",onClick:a(n)}))})},M=function(e){var t=e.points,n=e.onDragEnd,a=e.handleDelete;return o.a.createElement(O.a,{onDragEnd:n},o.a.createElement(O.c,{droppableId:"points"},function(e){return o.a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),t.map(function(e,t){return o.a.createElement(C,{key:t,name:e.name,index:t,handleDelete:a})}),e.placeholder)}))},_=n(19),x=n.n(_),P=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(u.a)({},e.target.name,e.target.value))},n.handleKeyDown=function(e){if(13===e.keyCode){if(n.cache[n.state.inputValue])return void n.setState(function(e){return{points:e.points.concat({name:n.state.inputValue,coords:n.cache[n.state.inputValue]}),inputValue:""}});window.ymaps.geocode(n.state.inputValue,{results:1}).then(function(e){var t=e.geoObjects.get(0).geometry.getCoordinates();n.cache[n.state.inputValue]=t,n.setState(function(e){return{points:e.points.concat({name:n.state.inputValue,coords:t}),inputValue:""}})}).catch(function(e){return console.log(e)})}},n.handleDelete=function(e){return function(){n.setState(function(t){return{points:[].concat(Object(c.a)(t.points.slice(0,e)),Object(c.a)(t.points.slice(e+1)))}})}},n.handleMoveMarker=function(e,t){window.ymaps.geocode(t,{results:1}).then(function(a){var o=a.geoObjects.get(0).properties.get("text");n.setState(function(n){return{points:n.points.map(function(n,a){return e===a?{name:o,coords:t}:n})}})}).catch(function(e){return console.log(e)})},n.onDragEnd=function(e){if(e.destination&&e.destination.index!==e.source.index){var t=n.state.points.slice(),a=t.splice(e.source.index,1),o=Object(s.a)(a,1)[0];t.splice(e.destination.index,0,o),n.setState({points:t})}},n.state={points:[],inputValue:""},n.cache={},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:x.a.header},o.a.createElement("h1",null,"Route Editor")),o.a.createElement("div",{className:x.a.content},o.a.createElement("div",{className:x.a["route-points-block"]},o.a.createElement(y,{handleChange:this.handleChange,handleKeyDown:this.handleKeyDown,value:this.state.inputValue}),o.a.createElement(M,{points:this.state.points,onDragEnd:this.onDragEnd,handleDelete:this.handleDelete})),o.a.createElement(v,{points:this.state.points,handleMoveMarker:this.handleMoveMarker})))}}]),t}(a.Component);i.a.render(o.a.createElement(P,null),document.getElementById("root"))}},[[49,2,1]]]);
//# sourceMappingURL=main.ad475516.chunk.js.map